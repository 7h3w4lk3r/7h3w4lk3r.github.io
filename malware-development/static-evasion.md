# Static Evasion

## <mark style="color:red;">Introduction</mark>

Static malware analysis is a method used to analyze malicious software (malware) without actually executing it. It involves examining the malware's code, structure, and behavior to understand its characteristics, potential impact, and methods of propagation. Static analysis is generally safer than dynamic analysis (executing the malware), as it doesn't run the risk of activating the malware's harmful functions. Antivirus (AV) and Endpoint Detection and Response (EDR) solutions use various techniques for static malware analysis to detect and mitigate threats.&#x20;



## <mark style="color:red;">Common Static Analysis Techniques</mark>

Here are some common techniques employed:

1. <mark style="color:green;">**Signature-based Detection:**</mark> This is the most basic form of detection. It involves comparing the digital signature (hash) of the malware's file against a database of known malicious signatures. If a match is found, the file is flagged as malware.
2. <mark style="color:green;">**String Analysis:**</mark> Malware often contains characteristic strings or keywords (mostly printable strings and characters) that can indicate its malicious intent. AV/EDR solutions scan the file for these strings, which might include network-related commands, suspicious file paths, or certain function names.
3. <mark style="color:green;">**Metadata Analysis:**</mark> File metadata, such as the compiler used, timestamps, and digital signatures, can provide insights into the malware's origin and authenticity. Metadata that doesn't match legitimate software can be an indicator of malicious activity.
4. <mark style="color:green;">**PE (Portable Executable) Header Analysis:**</mark> For Windows executables, the PE header contains information about the file's structure and properties. Analysis of this header can reveal anomalies, such as missing or tampered sections.
5. <mark style="color:green;">**File Compression and Encryption Detection:**</mark> Malware might be compressed or encrypted to avoid detection. Static analysis can identify patterns associated with common compression or encryption algorithms.
6. <mark style="color:green;">**Dependency Analysis:**</mark> Malware often relies on specific libraries, APIs, or resources. Identifying these dependencies can help in understanding the malware's capabilities and potential impact.
7. <mark style="color:green;">**Code Obfuscation and Packing Detection:**</mark> Malware authors often obfuscate or "pack" their code to evade detection. Static analysis attempts to reverse these techniques to reveal the actual code and behavior.
8. <mark style="color:green;">**File Entropy Analysis:**</mark> Entropy refers to the randomness or unpredictability of data within a file. In the context of malware analysis, this technique involves measuring the entropy of the bytes in a file to determine whether the file's contents appear to be highly structured (low entropy) or more random (high entropy).
9. <mark style="color:green;">**Control Flow Analysis:**</mark> Analyzing the flow of instructions within the malware's code can reveal loops, conditionals, and potential points of interest. This helps in understanding how the malware operates.
10. <mark style="color:green;">**Function Call Analysis:**</mark> Studying the functions called by the malware can provide insights into its behavior, such as whether it attempts to spread, establish persistence, or communicate with a command and control server.
11. <mark style="color:green;">**Import/Export Table Examination:**</mark> Looking at the functions imported and exported by the malware can indicate its capabilities and potential interaction with the operating system or other software.
12. <mark style="color:green;">**Behavioral Patterns:**</mark> Certain types of malware exhibit characteristic behaviors. Static analysis can help identify these patterns, such as the creation of autorun entries, modification of system files, or attempts to escalate privileges.
13. <mark style="color:green;">**Machine Learning and Heuristics:**</mark> Some AV/EDR solutions use machine learning models and heuristics to identify suspicious files based on patterns and anomalies found in the code.\












